
# ðŸ§© MongoDB Shell Commands 

ðŸ”§ Shell: `mongo` or `mongosh`  
ðŸŒ Purpose: Interact directly with MongoDB to **view, query, insert, update, and manage data**

---

## ðŸŸ¢ SECTION 1 â€“ Getting Started with the Mongo Shell

### â–¶ï¸ Connect to MongoDB:

* Local default:

```bash
mongo
````

- With port:
    

```bash
mongo --port 27017
```

- With username/password:
    

```bash
mongo --username myUser --password myPass --authenticationDatabase admin
```

---

## ðŸ—‚ SECTION 2 â€“ Database Basics

### ðŸ”¹ List all databases:

```js
show dbs
```

### ðŸ”¹ Switch (or create) a database:

```js
use myDatabase
```

> âš ï¸ This creates the DB only when a collection is written to.

### ðŸ”¹ Check current database:

```js
db
```

### ðŸ”¹ List all collections in the current DB:

```js
show collections
```

---

## ðŸ“¦ SECTION 3 â€“ Insert Documents (Create)

### ðŸ”¹ Insert one document:

```js
db.users.insertOne({ name: "Ali", age: 25, active: true })
```

### ðŸ”¹ Insert many documents:

```js
db.users.insertMany([
  { name: "Sara", age: 30 },
  { name: "Reza", age: 20 }
])
```

> MongoDB will auto-assign `_id` (ObjectId) unless you manually provide one.

---

## ðŸ”Ž SECTION 4 â€“ Find Documents (Read)

### ðŸ”¹ Find all:

```js
db.users.find()
```

### ðŸ”¹ Pretty print output:

```js
db.users.find().pretty()
```

### ðŸ”¹ Find with filter:

```js
db.users.find({ name: "Ali" })
```

### ðŸ”¹ Find one:

```js
db.users.findOne({ age: { $lt: 30 } })
```

### ðŸ”¹ Use projection (select specific fields):

```js
db.users.find({ age: { $gt: 20 } }, { name: 1, _id: 0 })
```

---

## ðŸ§  SECTION 5 â€“ Filters in Depth

|Filter Type|Example|
|---|---|
|Equality|`{ name: "Ali" }`|
|Comparison|`{ age: { $gt: 25 } }`|
|Logical|`{ $or: [ { age: 20 }, { age: 30 } ] }`|
|`$in`|`{ name: { $in: ["Ali", "Sara"] } }`|
|Exists|`{ email: { $exists: true } }`|
|Type|`{ age: { $type: "string" } }`|
|Array Match|`{ tags: { $all: ["node", "go"] } }`|
|Regex|`{ name: /ali/i }`|

---

## âœï¸ SECTION 6 â€“ Update Documents

### ðŸ”¹ Update one:

```js
db.users.updateOne(
  { name: "Ali" },
  { $set: { age: 26 } }
)
```

### ðŸ”¹ Update many:

```js
db.users.updateMany(
  { age: { $lt: 30 } },
  { $inc: { age: 1 } }
)
```

### ðŸ”¹ Replace document:

```js
db.users.replaceOne(
  { name: "Ali" },
  { name: "Ali", age: 28, active: false }
)
```

### ðŸ”¹ Upsert (update or insert if not exists):

```js
db.users.updateOne(
  { name: "NewGuy" },
  { $set: { age: 20 } },
  { upsert: true }
)
```

---

## ðŸ—‘ï¸ SECTION 7 â€“ Delete Documents

### ðŸ”¹ Delete one:

```js
db.users.deleteOne({ name: "Ali" })
```

### ðŸ”¹ Delete many:

```js
db.users.deleteMany({ age: { $lt: 20 } })
```

> âš ï¸ `deleteMany({})` will delete **ALL** documents.

---

## ðŸ§© SECTION 8 â€“ Query Modifiers

### ðŸ”¹ Sorting:

```js
db.users.find().sort({ age: -1 }) // descending
```

### ðŸ”¹ Limiting:

```js
db.users.find().limit(5)
```

### ðŸ”¹ Skipping:

```js
db.users.find().skip(3)
```

### ðŸ”¹ Combined:

```js
db.users.find().sort({ age: 1 }).skip(5).limit(10)
```

---

## ðŸ“Š SECTION 9 â€“ Counting & Distinct

### ðŸ”¹ Count documents:

```js
db.users.countDocuments({ active: true })
```

### ðŸ”¹ Get unique values:

```js
db.users.distinct("name")
```

---

## ðŸ› ï¸ SECTION 10 â€“ Schema Management

### ðŸ”¹ Rename a field:

```js
db.users.updateMany({}, { $rename: { "oldName": "newName" } })
```

### ðŸ”¹ Remove a field:

```js
db.users.updateMany({}, { $unset: { "tempField": "" } })
```

---

## ðŸ“Œ SECTION 11 â€“ Indexes

### ðŸ”¹ Create index:

```js
db.users.createIndex({ age: 1 }) // ascending
```

### ðŸ”¹ Create unique index:

```js
db.users.createIndex({ email: 1 }, { unique: true })
```

### ðŸ”¹ List all indexes:

```js
db.users.getIndexes()
```

### ðŸ”¹ Drop index:

```js
db.users.dropIndex("email_1")
```

---

## ðŸ” SECTION 12 â€“ Looping & Scripting

### ðŸ”¹ Loop through documents:

```js
db.users.find().forEach(user => print(user.name))
```

### ðŸ”¹ Save query result to variable:

```js
var user = db.users.findOne({ name: "Ali" });
print(user.age)
```

---

## ðŸš¨ SECTION 13 â€“ Useful Admin Commands

### ðŸ”¹ Show current DB:

```js
db
```

### ðŸ”¹ Show stats:

```js
db.users.stats()
```

### ðŸ”¹ Show connection info:

```js
db.runCommand({ connectionStatus: 1 })
```

---

## ðŸŽ“ Bonus: Good Practices for Interns

|Practice|Why it matters|
|---|---|
|Always test queries with `find()` before `update()` or `delete()`|Avoid accidental data loss|
|Use `limit()` when debugging|Avoid console overflow|
|Prefer `countDocuments()` over deprecated `count()`|More accurate results|
|Index fields used in filters|Speeds up query performance|
|Use Compass GUI to visualize|Helpful for learning structure|

---

## âœ… Summary Cheat Sheet

|Task|Command Example|
|---|---|
|Use DB|`use myDatabase`|
|Insert|`insertOne({ name: "Ali" })`|
|Find|`find({ age: { $gt: 20 } })`|
|Update|`updateOne({ name: "Ali" }, { $set: { age: 30 } })`|
|Delete|`deleteMany({ active: false })`|
|Sort|`find().sort({ age: -1 })`|
|Limit|`find().limit(5)`|
|Count|`countDocuments({})`|
|Index|`createIndex({ email: 1 }, { unique: true })`|

---

## ðŸ”¥ Adding Multiple Key:Value Pairs to an Object Field in One Update

You can add or update multiple keys inside an existing object (map) with one `$set`:

```js
db.collection.updateOne(
  { "user.twitter_id": "1919007997931458560" },
  {
    $set: {
      "following.new_key1": "value1",
      "following.new_key2": 123,
      "following.new_key3": true
    }
  }
)
```

> Each key uses dot notation inside the nested object.

---

### Example with your collection (`twitter_v2`):

```js
db.twitter_v2.updateOne(
  { "user.twitter_id": "1919007997931458560" },
  {
    $set: {
      "following.new_key1": "value1",
      "following.new_key2": 123,
      "following.new_key3": true
    }
  }
)
```

---

### To update multiple documents, use `updateMany()` similarly.

---

### Bonus: Update multiple nested objects in one update:

```js
db.twitter_v2.updateOne(
  { "user.twitter_id": "1919007997931458560" },
  {
    $set: {
      "following.new_key1": "value1",
      "oauth1_credentials.consumer_key": "newConsumerKey",
      "user.name": "Ryan Updated"
    }
  }
)
```

---

Let me know if you want me to add this to the full advanced tutorial or provide array update examples!